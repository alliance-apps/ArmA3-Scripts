<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="description" content="">
		<meta name="author" content="">

		<title>Fahrzeug/Haus Handel Tutorial (Deutsch)</title>

		<!-- Bootstrap core CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">

		<!-- Custom styles for this template -->
		<link href="https://getbootstrap.com/docs/4.0/examples/grid/grid.css" rel="stylesheet">
	</head>

	<body>
	<p style="display: inline; position: absolute; right: 5px; top: 5px;">Stand: 21.12.2017</p>

		<div class="container">
				<table style="width:100%">
					<tr>
						<th><h1>Tutorial: Fahrzeug/Haus Handel</h1></th>
						<th><a href="https://www.allianceapps.de"><img src="https://allianceapps.de/images/linksoben.png" height="75" align="right"></a></th>
					</tr>
				</table>
			<h3>Hinweis</h3>
			<p>In diesem Tutorial verändert ihr Dateien in eurer Mission sowie in eurem @life_server - das wichtigste sind also Backups! Ernsthaft, macht Backups von allen Daten bevor es hier weitergeht. AllianceApps ist nicht verantwortlich für eventuell verlorene Daten o. ä. </p>		
			<h3>Schritt 1</h3>
			Erstelle im <code>/core/</code> Ordner deiner Mission (.Altis, .Tanoa usw.) eine Datei namens <code>allianceapps_license.txt</code> (oder öffne Sie, wenn sie bereits existiert). Öffne diese und füge in einer neuen Zeile folgendes ein:
			<br>
			<code>OBJECT_SELL: &lt;HIER CODE EINFÜGEN></code><br>
			Dies ist der Lizenzschlüssel für das Produkt. Dieser ermöglicht uns zu identifizieren, ob du das Produkt legal erworben hast.
			<hr>
			<div class="alert alert-danger" role="alert">
				Folgendes muss in der <b>Mission</b> erfolgen (.Altis, .Tanoa, .Malden usw.):<br>
			</div>
			<h3>Schritt 2</h3>
			<p>Kopiere die Datei <code>aapps_sellobject.hpp</code> in den Ordner <code>/dialog/</code>.</p>
			<p>Öffne <code>/dialog/MasterHandler.hpp</code> und füge das Nachfolgende am Ende ein:<br>
			<pre class="prettyprint">#include "aapps_sellobject.hpp"</pre></p>

			
			<h3>Schritt 3</h3>
			<p>Kopiere die Datei <code>/fn_aapps_sellObject.sqf</code> in den Ordner <code>/core/functions/</code> in deiner Mission.</p>
			<p>Öffne <code>/Functions.hpp</code> bzw. <code>/Functions.h</code> und suche nach folgendem:<br>
			<pre class="prettyprint">class Functions {
	file = "core\functions";</pre>
      Füge unter <code>file = "core\functions";</code> folgendes ein: <code>class aapps_sellObject {};</code>. Der Teil der Datei sollte jetzt also so aussehen:<br>
      <pre class="prettyprint">class Functions {
        file = "core\functions";
	class aapps_sellObject {};</pre></p>
		<h3>Schritt 4</h3>
		<p>Öffne nun deine <code>/core/init.sqf</code> und füge folgendes unter <code>[] spawn life_fnc_survival;</code> ein:<br>
		<pre class="prettyprint">0 call life_fnc_aapps_sellObject;</pre>
      </p>
	  <h3>Schritt 5</h3>
		<p>Öffne nun deine <code>/core/housing/fn_houseMenu.sqf</code> und suche:<br>
		<pre class="prettyprint">if (((_curTarget getVariable "house_owner") select 0) != getPlayerUID player) then {
	_Btn1 ctrlEnable false;
};</pre>
		Ersetze diesen Teil mit Folgendem: <br>
		<pre class="prettyprint">if (((_curTarget getVariable "house_owner") select 0) != getPlayerUID player) then {
	_Btn1 ctrlEnable false;
} else {
	_Btn8 ctrlSetText localize "STR_trade_sell_object";
	_Btn8 buttonSetAction "[life_pInact_curTarget] call life_fnc_initSellObject";
	_Btn8 ctrlShow true;
};</pre>
	Suche nach:<br>
	<pre class="prettyprint">if (((_curTarget getVariable "house_owner") select 0) != (getPlayerUID player)) then {
	_Btn4 ctrlEnable false;
};</pre>
		Ersetze diesen Teil mit Folgendem: <br>
		<pre class="prettyprint">if (((_curTarget getVariable "house_owner") select 0) != (getPlayerUID player)) then {
	_Btn4 ctrlEnable false;
} else {
	_Btn8 ctrlSetText localize "STR_trade_sell_object";
	_Btn8 buttonSetAction "[life_pInact_curTarget] call life_fnc_initSellObject";
	_Btn8 ctrlShow true;
};</pre>

      </p>
	  <h3>Schritt 6</h3>
		<p>Öffne nun deine <code>/core/vehicle/fn_vInteractionMenu.sqf</code> und suche am Ende der Datei nach folgendem:<br>
		<pre class="prettyprint">_Btn4 ctrlShow false;
_Btn5 ctrlShow false;
_Btn6 ctrlShow false;</pre>
		Ersetze diesen Teil mit Folgendem: <br>
		<pre class="prettyprint">_Btn4 ctrlShow false;
_Btn5 ctrlShow false;
if(((_curTarget getVariable ['dbInfo',['-1',-1]]) select 0) isEqualTo (getplayeruid player)) then {
	_Btn6 ctrlSetText localize "STR_trade_sell_object";
	_Btn6 buttonSetAction "[life_vInact_curTarget] call life_fnc_initSellObject";
	_Btn6 ctrlShow true;
} else {
	_Btn6 ctrlShow false;
};</pre>
      </p>
	  <h3>Schritt 7</h3>
	  <p>
		Öffne deine <code>/CfgRemoteExec.hpp</code> und füge unter <code>F(life_fnc_animSync,ANYONE)</code> folgendes ein:
		<pre class="prettyprint">F(life_fnc_acceptSellRequest,CLIENT)
F(life_fnc_doneObjectSell,CLIENT)
F(life_fnc_sellobject_keys,CLIENT)
F(ton_fnc_aapps_changeObjectOwner,SERVER)</pre>
	  </p>
	  <h3>Schritt 8</h3>
		<p>Öffne die Datei <code>/stringtable.xml</code> und gehe an das Ende der Datei. Füge nun vor dem letzten <code>&lt;/Project&gt;</code> - Tag den Inhalt der beigelegten <b>Stringtable.xml</b> ein.</P>

		<br>
		<div class="alert alert-danger" role="alert">
			Folgendes muss im <b>@life_server</b> erfolgen:<br>
		</div>
		<h3>Schritt 9</h3>
		<p>
		<p>Kopiere die Datei <code>/fn_aapps_changeObjectOwner.sqf</code> in den Ordner <code>/Functions/Systems/</code> in deinem Life_Server.</p>
			<p>Öffne deine <code>/config.cpp</code> und suche nach folgendem:<br>
			<pre class="prettyprint">class Systems {
	file = "\life_server\Functions\Systems";</pre>
      Füge unter <code>file = "\life_server\Functions\Systems";</code> folgendes ein: <code>class aapps_changeObjectOwner {};</code>. Der Teil der Datei sollte jetzt also so aussehen:<br>
      <pre class="prettyprint">class Systems {
	file = "\life_server\Functions\Systems";
	class aapps_changeObjectOwner {};</pre></p>
	<br>
		<div class="alert alert-danger" role="alert">
				Folgendes muss in der <b>Datenbank</b> erfolgen:<br>
			</div>
			<h3>Schritt 10</h3>
			<p>	
				Führe die folgende Abfrage in deiner <b>Altis Life Datenbank</b> aus: 
				<pre class="prettyprint">CREATE TABLE IF NOT EXISTS `sold_objects` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `olduid` varchar(17) NOT NULL,
  `newuid` varchar(17) NOT NULL,
  `index_value` varchar(17) NOT NULL,
  `object_classname` tinytext NOT NULL,
  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;</pre>
			</p>
		<h3 align='center'><div class="alert alert-success" role="alert">Gratulation. Du hast nun den Fahrzeug/Häuser Handel erfolgreich installiert.</div></h3>
		</div> <!-- /container -->

		<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=sunburst""></script>
	</body>
</html>
